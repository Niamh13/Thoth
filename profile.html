<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="CSS/styles.css"/>
    <title>Book Page</title>
</head>
<body onload="checkLoginStatus()">
<!-- Navigation bar section -->
<div class="TopNav">
    <!-- Navigation links -->
    <a class="link" href="index.html">Home</a>
    <a class="link" href="search.html">Search</a>

    <!-- Dropdown menu for user profile and settings -->
    <div class="dropdown">
        <button class="dropbtn" onclick="toggleDropdown()">
            <!-- User icon in the dropdown button -->
            <img src="Images/user.png" alt="User" style="vertical-align: middle;">
        </button>

        <!-- Dropdown content hidden by default shown on click -->
        <div class="DropdownContent" id="DropdownContent">
            <a href="profile.html">My Profile</a>
            <a href="library.html">My Library</a>
            <a href="contact.html">Customer Service</a>
            <!-- Logout link with inline onclick event to call logout function -->
                <form method="post" action="PHP/logout.php">
                    <button name="logoutButton" class="logoutButton">Logout</button>
                </form>
        </div>
    </div>

    <!-- Hamburger icon for mobile navigation menu -->
    <a href="javascript:void(0);" class="icon" onclick="openSideNav()">&#9776;</a>
</div>

<!-- Side navigation menu hidden by default -->
<div id="SideNav" class="SideNav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeSideNav()">&times;</a>
    <a class="link" href="index.html">Home</a>
    <a class="link" href="search.html">Search</a>
</div>

<div id="sect"></div>


<script src="JavaScript/script.js"></script>
<!--php connection-->
<?php
session_start();

include('bookSave.php');
include('login.php');
include('checkLogin.php');

$username = $_SESSION["username"];
$loggIn = $_SESSION["loggIn"];

// database connect
$host = "localhost";
$dbusername = "root";
$dbpassword = "Timmy2013"; // depends on password
$dbname = "auth";

$conn = new mysqli($host, $dbusername, $dbpassword, $dbname);

if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}

if($loggIn == true){
    $getName = "SELECT fullname FROM login WHERE username = '$username'";
    $getEmail = "SELECT email FROM login WHERE username = '$username'";
    $uName = $conn->query($getName);
    $uEmail = $conn->query($getEmail);
    echo '<script type="text/javascript">
        const profileSect = document.getElementById("sect");
        const profileInfo = `
            	<div class="profileResults">
                    <p>Name: '$uName'</p>
                    <br>
                    <p>Email: '$uEmail'</p>
                    <br>
                    <p>Username: '$username'</p>
                </div>
        `;
    </script>';
}
else if($loggIn == false){
    echo '<script type="text/javascript">alert("Please log in"); window.location.href = "/signup.html";</script>';
}
else{
    echo '<script type="text/javascript">console.log("ERROR")</script>';
}

?>
</body>
</html>
